import{s as G,f as y,a as U,g as E,N as z,c as D,j as I,i as k,d as c,z as V,l as A,h as W,m as T,L as g,n as O,F as M,p as J,S as Q,T as X}from"../chunks/scheduler.300f34fd.js";import{S as x,i as ee,b as P,d as q,m as B,a as S,t as N,e as L,g as te,c as se,k as le}from"../chunks/index.93d9ee7e.js";import{b as ae,u as ne,f as H,e as R,h as re,W as oe,s as ie,i as fe}from"../chunks/firebase.ee006204.js";import{A as ue}from"../chunks/AuthCheck.689186b5.js";import{g as ce,I as me}from"../chunks/input.0d01099c.js";import{C as pe,a as _e,b as $e,c as he,d as de}from"../chunks/card-title.f7eab975.js";import{C as ge}from"../chunks/card-footer.251a499f.js";import"../chunks/index.72792d10.js";import{B as be}from"../chunks/button.a3f1943d.js";function j(r){let e,s,l,o,t,n,a=r[6].username+"",i,b,v,_="Change Username",C,h,p="Sign out",u,$,d;return e=new pe({props:{$$slots:{default:[ye]},$$scope:{ctx:r}}}),{c(){P(e.$$.fragment),s=U(),l=y("p"),o=A("Your username is "),t=y("span"),n=A("@"),i=A(a),b=U(),v=y("h2"),v.textContent=_,C=U(),h=y("button"),h.textContent=p,this.h()},l(f){q(e.$$.fragment,f),s=D(f),l=E(f,"P",{class:!0});var m=W(l);o=T(m,"Your username is "),t=E(m,"SPAN",{class:!0});var w=W(t);n=T(w,"@"),i=T(w,a),w.forEach(c),m.forEach(c),b=D(f),v=E(f,"H2",{["data-svelte-h"]:!0}),z(v)!=="svelte-1pqqmj2"&&(v.textContent=_),C=D(f),h=E(f,"BUTTON",{class:!0,["data-svelte-h"]:!0}),z(h)!=="svelte-thboqa"&&(h.textContent=p),this.h()},h(){I(t,"class","text-success font-bold"),I(l,"class","text-lg"),I(h,"class","btn btn-accent w-fit px-4")},m(f,m){B(e,f,m),k(f,s,m),k(f,l,m),g(l,o),g(l,t),g(t,n),g(t,i),k(f,b,m),k(f,v,m),k(f,C,m),k(f,h,m),u=!0,$||(d=M(h,"click",r[10]),$=!0)},p(f,m){const w={};m&8223&&(w.$$scope={dirty:m,ctx:f}),e.$set(w),(!u||m&64)&&a!==(a=f[6].username+"")&&O(i,a)},i(f){u||(S(e.$$.fragment,f),u=!0)},o(f){N(e.$$.fragment,f),u=!1},d(f){f&&(c(s),c(l),c(b),c(v),c(C),c(h)),L(e,f),$=!1,d()}}}function ve(r){let e;return{c(){e=A("Username")},l(s){e=T(s,"Username")},m(s,l){k(s,e,l)},d(s){s&&c(e)}}}function ke(r){let e;return{c(){e=A("Change your username here.")},l(s){e=T(s,"Change your username here.")},m(s,l){k(s,e,l)},d(s){s&&c(e)}}}function Ce(r){let e,s,l,o;return e=new he({props:{$$slots:{default:[ve]},$$scope:{ctx:r}}}),l=new de({props:{$$slots:{default:[ke]},$$scope:{ctx:r}}}),{c(){P(e.$$.fragment),s=U(),P(l.$$.fragment)},l(t){q(e.$$.fragment,t),s=D(t),q(l.$$.fragment,t)},m(t,n){B(e,t,n),k(t,s,n),B(l,t,n),o=!0},p(t,n){const a={};n&8192&&(a.$$scope={dirty:n,ctx:t}),e.$set(a);const i={};n&8192&&(i.$$scope={dirty:n,ctx:t}),l.$set(i)},i(t){o||(S(e.$$.fragment,t),S(l.$$.fragment,t),o=!0)},o(t){N(e.$$.fragment,t),N(l.$$.fragment,t),o=!1},d(t){t&&c(s),L(e,t),L(l,t)}}}function F(r){let e,s,l,o;return{c(){e=y("p"),s=A("Checking availability of @"),l=A(r[0]),o=A("..."),this.h()},l(t){e=E(t,"P",{class:!0});var n=W(e);s=T(n,"Checking availability of @"),l=T(n,r[0]),o=T(n,"..."),n.forEach(c),this.h()},h(){I(e,"class","text-secondary")},m(t,n){k(t,e,n),g(e,s),g(e,l),g(e,o)},p(t,n){n&1&&O(l,t[0])},d(t){t&&c(e)}}}function K(r){let e,s="must be 3-16 characters long, alphanumeric only";return{c(){e=y("p"),e.textContent=s,this.h()},l(l){e=E(l,"P",{class:!0,["data-svelte-h"]:!0}),z(e)!=="svelte-k3aqf9"&&(e.textContent=s),this.h()},h(){I(e,"class","text-error text-sm")},m(l,o){k(l,e,o)},d(l){l&&c(e)}}}function Y(r){let e,s,l,o;return{c(){e=y("p"),s=A("@"),l=A(r[0]),o=A(" is not available"),this.h()},l(t){e=E(t,"P",{class:!0});var n=W(e);s=T(n,"@"),l=T(n,r[0]),o=T(n," is not available"),n.forEach(c),this.h()},h(){I(e,"class","text-warning text-sm")},m(t,n){k(t,e,n),g(e,s),g(e,l),g(e,o)},p(t,n){n&1&&O(l,t[0])},d(t){t&&c(e)}}}function Z(r){let e,s,l;return{c(){e=y("button"),s=A("Confirm username @"),l=A(r[0]),this.h()},l(o){e=E(o,"BUTTON",{class:!0});var t=W(e);s=T(t,"Confirm username @"),l=T(t,r[0]),t.forEach(c),this.h()},h(){I(e,"class","btn btn-success")},m(o,t){k(o,e,t),g(e,s),g(e,l)},p(o,t){t&1&&O(l,o[0])},d(o){o&&c(e)}}}function we(r){let e,s,l,o,t,n,a,i,b,v,_;function C(f){r[9](f)}let h={type:"text",placeholder:"Username",class:"input w-fit input-bordered"};r[0]!==void 0&&(h.value=r[0]),s=new me({props:h}),J.push(()=>le(s,"value",C)),s.$on("input",r[7]),s.$on("keydown",Se);let p=r[1]&&F(r),u=!r[3]&&r[4]&&K(),$=r[3]&&!r[2]&&!r[1]&&Y(r),d=r[2]&&Z(r);return{c(){e=y("form"),P(s.$$.fragment),o=U(),t=y("div"),p&&p.c(),n=U(),u&&u.c(),a=U(),$&&$.c(),i=U(),d&&d.c(),this.h()},l(f){e=E(f,"FORM",{class:!0});var m=W(e);q(s.$$.fragment,m),o=D(m),t=E(m,"DIV",{class:!0});var w=W(t);p&&p.l(w),n=D(w),u&&u.l(w),a=D(w),$&&$.l(w),i=D(w),d&&d.l(w),w.forEach(c),m.forEach(c),this.h()},h(){I(t,"class","my-4 min-h-16 w-full"),I(e,"class","w-2/5")},m(f,m){k(f,e,m),B(s,e,null),g(e,o),g(e,t),p&&p.m(t,null),g(t,n),u&&u.m(t,null),g(t,a),$&&$.m(t,null),g(t,i),d&&d.m(t,null),b=!0,v||(_=M(e,"submit",Q(r[8])),v=!0)},p(f,m){const w={};!l&&m&1&&(l=!0,w.value=f[0],X(()=>l=!1)),s.$set(w),f[1]?p?p.p(f,m):(p=F(f),p.c(),p.m(t,n)):p&&(p.d(1),p=null),!f[3]&&f[4]?u||(u=K(),u.c(),u.m(t,a)):u&&(u.d(1),u=null),f[3]&&!f[2]&&!f[1]?$?$.p(f,m):($=Y(f),$.c(),$.m(t,i)):$&&($.d(1),$=null),f[2]?d?d.p(f,m):(d=Z(f),d.c(),d.m(t,null)):d&&(d.d(1),d=null)},i(f){b||(S(s.$$.fragment,f),b=!0)},o(f){N(s.$$.fragment,f),b=!1},d(f){f&&c(e),L(s),p&&p.d(),u&&u.d(),$&&$.d(),d&&d.d(),v=!1,_()}}}function Ae(r){let e;return{c(){e=A("Save")},l(s){e=T(s,"Save")},m(s,l){k(s,e,l)},d(s){s&&c(e)}}}function Te(r){let e,s;return e=new be({props:{$$slots:{default:[Ae]},$$scope:{ctx:r}}}),{c(){P(e.$$.fragment)},l(l){q(e.$$.fragment,l)},m(l,o){B(e,l,o),s=!0},p(l,o){const t={};o&8192&&(t.$$scope={dirty:o,ctx:l}),e.$set(t)},i(l){s||(S(e.$$.fragment,l),s=!0)},o(l){N(e.$$.fragment,l),s=!1},d(l){L(e,l)}}}function ye(r){let e,s,l,o,t,n;return e=new _e({props:{$$slots:{default:[Ce]},$$scope:{ctx:r}}}),l=new $e({props:{$$slots:{default:[we]},$$scope:{ctx:r}}}),t=new ge({props:{class:"border-t px-6 py-4",$$slots:{default:[Te]},$$scope:{ctx:r}}}),{c(){P(e.$$.fragment),s=U(),P(l.$$.fragment),o=U(),P(t.$$.fragment)},l(a){q(e.$$.fragment,a),s=D(a),q(l.$$.fragment,a),o=D(a),q(t.$$.fragment,a)},m(a,i){B(e,a,i),k(a,s,i),B(l,a,i),k(a,o,i),B(t,a,i),n=!0},p(a,i){const b={};i&8192&&(b.$$scope={dirty:i,ctx:a}),e.$set(b);const v={};i&8223&&(v.$$scope={dirty:i,ctx:a}),l.$set(v);const _={};i&8192&&(_.$$scope={dirty:i,ctx:a}),t.$set(_)},i(a){n||(S(e.$$.fragment,a),S(l.$$.fragment,a),S(t.$$.fragment,a),n=!0)},o(a){N(e.$$.fragment,a),N(l.$$.fragment,a),N(t.$$.fragment,a),n=!1},d(a){a&&(c(s),c(o)),L(e,a),L(l,a),L(t,a)}}}function Ee(r){var b,v;let e,s,l,o=((b=r[5])==null?void 0:b.displayName)+"",t,n,a,i=((v=r[6])==null?void 0:v.username)&&j(r);return{c(){e=y("div"),s=y("h2"),l=A("Welcome, "),t=A(o),n=U(),i&&i.c(),this.h()},l(_){e=E(_,"DIV",{class:!0});var C=W(e);s=E(C,"H2",{});var h=W(s);l=T(h,"Welcome, "),t=T(h,o),h.forEach(c),n=D(C),i&&i.l(C),C.forEach(c),this.h()},h(){I(e,"class","flex flex-col gap-2")},m(_,C){k(_,e,C),g(e,s),g(s,l),g(s,t),g(e,n),i&&i.m(e,null),a=!0},p(_,C){var h,p;(!a||C&32)&&o!==(o=((h=_[5])==null?void 0:h.displayName)+"")&&O(t,o),(p=_[6])!=null&&p.username?i?(i.p(_,C),C&64&&S(i,1)):(i=j(_),i.c(),S(i,1),i.m(e,null)):i&&(te(),N(i,1,1,()=>{i=null}),se())},i(_){a||(S(i),a=!0)},o(_){N(i),a=!1},d(_){_&&c(e),i&&i.d()}}}function Ue(r){let e,s="Dashboard",l,o,t;return o=new ue({props:{$$slots:{default:[Ee]},$$scope:{ctx:r}}}),{c(){e=y("h2"),e.textContent=s,l=U(),P(o.$$.fragment),this.h()},l(n){e=E(n,"H2",{class:!0,["data-svelte-h"]:!0}),z(e)!=="svelte-romd70"&&(e.textContent=s),l=D(n),q(o.$$.fragment,n),this.h()},h(){I(e,"class","card-title mb-8")},m(n,a){k(n,e,a),k(n,l,a),B(o,n,a),t=!0},p(n,[a]){const i={};a&8319&&(i.$$scope={dirty:a,ctx:n}),o.$set(i)},i(n){t||(S(o.$$.fragment,n),t=!0)},o(n){N(o.$$.fragment,n),t=!1},d(n){n&&(c(e),c(l)),L(o,n)}}}const De=/^(?=[a-zA-Z0-9._]{3,16}$)(?!.*[_.]{2})[^_.].*[^_.]$/;function Se(r){const e=r.key;/^[a-zA-Z0-9]$/.test(e)||["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Enter"].includes(e)||r.preventDefault()}function Ie(r,e,s){let l,o,t,n;V(r,ae,u=>s(5,t=u)),V(r,ne,u=>s(6,n=u));let a="",i=!1,b=!1,v;async function _(){s(2,b=!1),clearTimeout(v),s(1,i=!0),v=setTimeout(async()=>{console.log("checking availability of",a);const u=H(R,"usernames",a),$=await re(u).then(d=>d.exists());s(2,b=!$),s(1,i=!1)},500)}async function C(){console.log("confirming username",a);const u=oe(R);u.set(H(R,"usernames",a),{uid:t==null?void 0:t.uid}),u.set(H(R,"users",t.uid),{username:a,photoURL:(t==null?void 0:t.photoURL)??null,published:!0,bio:"I am the Walrus",links:[{title:"Test Link",url:"https://kung.foo",icon:"custom"}]}),await u.commit(),s(0,a=""),s(2,b=!1)}function h(u){a=u,s(0,a)}const p=()=>{ie(fe),ce("/")};return r.$$.update=()=>{r.$$.dirty&1&&s(3,l=(a==null?void 0:a.length)>2&&a.length<16&&De.test(a)),r.$$.dirty&1&&s(4,o=a.length>0),r.$$.dirty&14},[a,i,b,l,o,t,n,_,C,h,p]}class He extends x{constructor(e){super(),ee(this,e,Ie,Ue,G,{})}}export{He as component};
