import{s as G,z as W,a as A,c as E,i as d,d as m,e as j,l as h,m as g,f as w,g as y,h as B,j as v,L as _,X as F,F as I,S as M,G as X,N as q,n as S}from"../chunks/scheduler.300f34fd.js";import{S as H,i as J,b as P,d as T,m as U,a as N,t as D,e as L}from"../chunks/index.93d9ee7e.js";import{A as Q}from"../chunks/AuthCheck.689186b5.js";import{b as x,u as ee,f as z,e as R,h as te,W as se}from"../chunks/firebase.ee006204.js";import"../chunks/index.72792d10.js";import{C as ne,a as ae,b as le,c as re,d as oe}from"../chunks/card-title.f7eab975.js";import{C as fe}from"../chunks/card-footer.251a499f.js";import{B as K}from"../chunks/button.a3f1943d.js";function ie(o){let e;return{c(){e=h("Username")},l(n){e=g(n,"Username")},m(n,s){d(n,e,s)},d(n){n&&m(e)}}}function ue(o){let e;return{c(){e=h("Enter a username for your account.")},l(n){e=g(n,"Enter a username for your account.")},m(n,s){d(n,e,s)},d(n){n&&m(e)}}}function ce(o){let e,n,s,a;return e=new re({props:{class:"text-xl",$$slots:{default:[ie]},$$scope:{ctx:o}}}),s=new oe({props:{$$slots:{default:[ue]},$$scope:{ctx:o}}}),{c(){P(e.$$.fragment),n=A(),P(s.$$.fragment)},l(t){T(e.$$.fragment,t),n=E(t),T(s.$$.fragment,t)},m(t,r){U(e,t,r),d(t,n,r),U(s,t,r),a=!0},p(t,r){const l={};r&4096&&(l.$$scope={dirty:r,ctx:t}),e.$set(l);const f={};r&4096&&(f.$$scope={dirty:r,ctx:t}),s.$set(f)},i(t){a||(N(e.$$.fragment,t),N(s.$$.fragment,t),a=!0)},o(t){D(e.$$.fragment,t),D(s.$$.fragment,t),a=!1},d(t){t&&m(n),L(e,t),L(s,t)}}}function me(o){let e,n,s,a,t,r,l,f,b,i=o[1]&&O(o),c=!o[3]&&o[4]&&V(),p=o[3]&&!o[2]&&!o[1]&&Y(o),$=o[2]&&Z(o);return{c(){e=w("form"),n=w("input"),s=A(),a=w("div"),i&&i.c(),t=A(),c&&c.c(),r=A(),p&&p.c(),l=A(),$&&$.c(),this.h()},l(u){e=y(u,"FORM",{class:!0});var k=B(e);n=y(k,"INPUT",{type:!0,placeholder:!0,class:!0}),s=E(k),a=y(k,"DIV",{class:!0});var C=B(a);i&&i.l(C),t=E(C),c&&c.l(C),r=E(C),p&&p.l(C),l=E(C),$&&$.l(C),C.forEach(m),k.forEach(m),this.h()},h(){v(n,"type","text"),v(n,"placeholder","Username"),v(n,"class","input w-full"),v(a,"class","my-4 min-h-16 px-8 w-full"),v(e,"class","")},m(u,k){d(u,e,k),_(e,n),F(n,o[0]),_(e,s),_(e,a),i&&i.m(a,null),_(a,t),c&&c.m(a,null),_(a,r),p&&p.m(a,null),_(a,l),$&&$.m(a,null),f||(b=[I(n,"input",o[8]),I(n,"input",o[6]),I(n,"keydown",Ce),I(e,"submit",M(o[7]))],f=!0)},p(u,k){k&1&&n.value!==u[0]&&F(n,u[0]),u[1]?i?i.p(u,k):(i=O(u),i.c(),i.m(a,t)):i&&(i.d(1),i=null),!u[3]&&u[4]?c||(c=V(),c.c(),c.m(a,r)):c&&(c.d(1),c=null),u[3]&&!u[2]&&!u[1]?p?p.p(u,k):(p=Y(u),p.c(),p.m(a,l)):p&&(p.d(1),p=null),u[2]?$?$.p(u,k):($=Z(u),$.c(),$.m(a,null)):$&&($.d(1),$=null)},d(u){u&&m(e),i&&i.d(),c&&c.d(),p&&p.d(),$&&$.d(),f=!1,X(b)}}}function pe(o){let e,n,s,a,t=o[5].username+"",r,l,f,b="(Usernames cannot be changed)";return{c(){e=w("p"),n=h("Your username is "),s=w("span"),a=h("@"),r=h(t),l=A(),f=w("p"),f.textContent=b,this.h()},l(i){e=y(i,"P",{class:!0});var c=B(e);n=g(c,"Your username is "),s=y(c,"SPAN",{class:!0});var p=B(s);a=g(p,"@"),r=g(p,t),p.forEach(m),c.forEach(m),l=E(i),f=y(i,"P",{class:!0,["data-svelte-h"]:!0}),q(f)!=="svelte-9l80or"&&(f.textContent=b),this.h()},h(){v(s,"class","text-success font-bold"),v(e,"class","text-lg"),v(f,"class","text-sm")},m(i,c){d(i,e,c),_(e,n),_(e,s),_(s,a),_(s,r),d(i,l,c),d(i,f,c)},p(i,c){c&32&&t!==(t=i[5].username+"")&&S(r,t)},d(i){i&&(m(e),m(l),m(f))}}}function O(o){let e,n,s,a;return{c(){e=w("p"),n=h("Checking availability of @"),s=h(o[0]),a=h("..."),this.h()},l(t){e=y(t,"P",{class:!0});var r=B(e);n=g(r,"Checking availability of @"),s=g(r,o[0]),a=g(r,"..."),r.forEach(m),this.h()},h(){v(e,"class","text-secondary")},m(t,r){d(t,e,r),_(e,n),_(e,s),_(e,a)},p(t,r){r&1&&S(s,t[0])},d(t){t&&m(e)}}}function V(o){let e,n="must be 3-16 characters long, alphanumeric only";return{c(){e=w("p"),e.textContent=n,this.h()},l(s){e=y(s,"P",{class:!0,["data-svelte-h"]:!0}),q(e)!=="svelte-vt0dol"&&(e.textContent=n),this.h()},h(){v(e,"class","text-error text-sm")},m(s,a){d(s,e,a)},d(s){s&&m(e)}}}function Y(o){let e,n,s,a;return{c(){e=w("p"),n=h("@"),s=h(o[0]),a=h(" is not available"),this.h()},l(t){e=y(t,"P",{class:!0});var r=B(e);n=g(r,"@"),s=g(r,o[0]),a=g(r," is not available"),r.forEach(m),this.h()},h(){v(e,"class","text-warning text-sm")},m(t,r){d(t,e,r),_(e,n),_(e,s),_(e,a)},p(t,r){r&1&&S(s,t[0])},d(t){t&&m(e)}}}function Z(o){let e,n,s;return{c(){e=w("button"),n=h("Confirm username @"),s=h(o[0]),this.h()},l(a){e=y(a,"BUTTON",{class:!0});var t=B(e);n=g(t,"Confirm username @"),s=g(t,o[0]),t.forEach(m),this.h()},h(){v(e,"class","btn btn-success")},m(a,t){d(a,e,t),_(e,n),_(e,s)},p(a,t){t&1&&S(s,a[0])},d(a){a&&m(e)}}}function $e(o){let e;function n(t,r){var l;return(l=t[5])!=null&&l.username?pe:me}let s=n(o),a=s(o);return{c(){a.c(),e=j()},l(t){a.l(t),e=j()},m(t,r){a.m(t,r),d(t,e,r)},p(t,r){s===(s=n(t))&&a?a.p(t,r):(a.d(1),a=s(t),a&&(a.c(),a.m(e.parentNode,e)))},d(t){t&&m(e),a.d(t)}}}function _e(o){let e;return{c(){e=h("Previous")},l(n){e=g(n,"Previous")},m(n,s){d(n,e,s)},d(n){n&&m(e)}}}function de(o){let e;return{c(){e=h("Next")},l(n){e=g(n,"Next")},m(n,s){d(n,e,s)},d(n){n&&m(e)}}}function he(o){let e,n,s,a;return e=new K({props:{href:"/signup",variant:"outline",$$slots:{default:[_e]},$$scope:{ctx:o}}}),s=new K({props:{href:"/signup/photo",variant:"outline",$$slots:{default:[de]},$$scope:{ctx:o}}}),{c(){P(e.$$.fragment),n=A(),P(s.$$.fragment)},l(t){T(e.$$.fragment,t),n=E(t),T(s.$$.fragment,t)},m(t,r){U(e,t,r),d(t,n,r),U(s,t,r),a=!0},p(t,r){const l={};r&4096&&(l.$$scope={dirty:r,ctx:t}),e.$set(l);const f={};r&4096&&(f.$$scope={dirty:r,ctx:t}),s.$set(f)},i(t){a||(N(e.$$.fragment,t),N(s.$$.fragment,t),a=!0)},o(t){D(e.$$.fragment,t),D(s.$$.fragment,t),a=!1},d(t){t&&m(n),L(e,t),L(s,t)}}}function ge(o){let e,n,s,a,t,r;return e=new ae({props:{$$slots:{default:[ce]},$$scope:{ctx:o}}}),s=new le({props:{class:"py-10",$$slots:{default:[$e]},$$scope:{ctx:o}}}),t=new fe({props:{class:"border-t px-6 py-4 flex justify-between",$$slots:{default:[he]},$$scope:{ctx:o}}}),{c(){P(e.$$.fragment),n=A(),P(s.$$.fragment),a=A(),P(t.$$.fragment)},l(l){T(e.$$.fragment,l),n=E(l),T(s.$$.fragment,l),a=E(l),T(t.$$.fragment,l)},m(l,f){U(e,l,f),d(l,n,f),U(s,l,f),d(l,a,f),U(t,l,f),r=!0},p(l,f){const b={};f&4096&&(b.$$scope={dirty:f,ctx:l}),e.$set(b);const i={};f&4159&&(i.$$scope={dirty:f,ctx:l}),s.$set(i);const c={};f&4096&&(c.$$scope={dirty:f,ctx:l}),t.$set(c)},i(l){r||(N(e.$$.fragment,l),N(s.$$.fragment,l),N(t.$$.fragment,l),r=!0)},o(l){D(e.$$.fragment,l),D(s.$$.fragment,l),D(t.$$.fragment,l),r=!1},d(l){l&&(m(n),m(a)),L(e,l),L(s,l),L(t,l)}}}function be(o){let e,n;return e=new ne({props:{class:"",$$slots:{default:[ge]},$$scope:{ctx:o}}}),{c(){P(e.$$.fragment)},l(s){T(e.$$.fragment,s)},m(s,a){U(e,s,a),n=!0},p(s,a){const t={};a&4159&&(t.$$scope={dirty:a,ctx:s}),e.$set(t)},i(s){n||(N(e.$$.fragment,s),n=!0)},o(s){D(e.$$.fragment,s),n=!1},d(s){L(e,s)}}}function ke(o){let e,n;return e=new Q({props:{$$slots:{default:[be]},$$scope:{ctx:o}}}),{c(){P(e.$$.fragment)},l(s){T(e.$$.fragment,s)},m(s,a){U(e,s,a),n=!0},p(s,[a]){const t={};a&4159&&(t.$$scope={dirty:a,ctx:s}),e.$set(t)},i(s){n||(N(e.$$.fragment,s),n=!0)},o(s){D(e.$$.fragment,s),n=!1},d(s){L(e,s)}}}const ve=/^(?=[a-zA-Z0-9._]{3,16}$)(?!.*[_.]{2})[^_.].*[^_.]$/;function Ce(o){const e=o.key;/^[a-zA-Z0-9]$/.test(e)||["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Enter"].includes(e)||o.preventDefault()}function we(o,e,n){let s,a,t,r;W(o,x,u=>n(11,t=u)),W(o,ee,u=>n(5,r=u));let l="",f=!1,b=!1,i;async function c(){n(2,b=!1),clearTimeout(i),n(1,f=!0),i=setTimeout(async()=>{console.log("checking availability of",l);const u=z(R,"usernames",l),k=await te(u).then(C=>C.exists());n(2,b=!k),n(1,f=!1)},500)}async function p(){console.log("confirming username",l);const u=se(R);u.set(z(R,"usernames",l),{uid:t==null?void 0:t.uid}),u.set(z(R,"users",t.uid),{username:l,photoURL:(t==null?void 0:t.photoURL)??null,published:!0,bio:"I am the Walrus",links:[{title:"Test Link",url:"https://kung.foo",icon:"custom"}]}),await u.commit(),n(0,l=""),n(2,b=!1)}function $(){l=this.value,n(0,l)}return o.$$.update=()=>{o.$$.dirty&1&&n(3,s=(l==null?void 0:l.length)>2&&l.length<16&&ve.test(l)),o.$$.dirty&1&&n(4,a=l.length>0),o.$$.dirty&14},[l,f,b,s,a,r,c,p,$]}class Le extends H{constructor(e){super(),J(this,e,we,ke,G,{})}}export{Le as component};
